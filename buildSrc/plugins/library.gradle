apply plugin: "java"
apply plugin: "eclipse"

repositories {  flatDir { dirs 'lib'
    }  }

dependencies {
    compile fileTree(dir: 'lib', include: '*.jar', exclude: '*-sources.jar')
}

eclipse {
    classpath {
        file {
            whenMerged { classpath ->
                classpath.entries.removeAll { entry ->
                    entry.kind == 'lib'
                }
            }
            withXml {
                def node = it.asNode()
                def componentPath = "${projectDir}/lib/$library"
                def componentSourcePath = "${projectDir}/lib-sources/$librarySources"
                node.appendNode('classpathentry', [kind: 'lib', path: componentPath, exported: true, sourcepath: componentSourcePath ])
                println "Forked classpath entry with source jar for ${library}"
            }
        }
    }
}

