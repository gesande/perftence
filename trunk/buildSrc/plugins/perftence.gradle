import net.sf.mygradlebuild.plugins.DefaultContinousBuildPlugin
import net.sf.mygradlebuild.plugins.EclipseSettingsPlugin
import net.sf.mygradlebuild.plugins.EnvironmentVariablesPlugin
import net.sf.mygradlebuild.plugins.JavaDistributionPlugin
import net.sf.mygradlebuild.plugins.MavenCentral
import net.sf.mygradlebuild.plugins.NewJavaProjectToSvnPlugin
import net.sf.mygradlebuild.plugins.ReportingPlugin
import net.sf.mygradlebuild.plugins.SvnPlugin
import net.sf.perftence.build.ExportAntBuildFilePlugin
import net.sf.perftence.build.PerftenceBuildPlugin

import org.gradle.api.JavaVersion
import org.gradle.api.Project

ext {
    //make sure these files exist
    jdtInputFile="${buildScripts}/template/for/eclipse/org.eclipse.jdt.core.prefs"

    pmdSettings="${buildScripts}/template/for/pmd/.pmd"

    distributionDir="$buildDir/distributions"

    toolsDir="${projectDir}/tools"

    emmaPlugin="${buildScripts}/plugins/jacoco.gradle"

    artifactVersion='2.2.3'

    distributionExcludes = ["*-lib.jar"]
    distributionBasename = 'perftence-distribution'
}

apply plugin: MavenCentral
apply plugin: NewJavaProjectToSvnPlugin
apply plugin : ReportingPlugin
apply plugin : JavaDistributionPlugin
apply plugin : EnvironmentVariablesPlugin
//apply plugin : EclipseSettingsPlugin
apply plugin : SvnPlugin
apply plugin : ExportAntBuildFilePlugin

apply plugin : PerftenceBuildPlugin

reportingSettings {
    toolsDirectory = "${toolsDir}"
    onlyAnalyze = 'net.sf.perftence'
    findbugsVersion = '3.0.1'
}


subprojects { Project prj ->
    version = prj.parent.artifactVersion
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
    apply plugin : DefaultContinousBuildPlugin
    forkJdt { jdtInputFile = "${project.properties.jdtInputFile}"  }
    pmd { toolVersion = '4.3'	}
}

