import static org.gradle.logging.StyledTextOutput.Style

import org.gradle.logging.StyledTextOutput
import org.gradle.logging.StyledTextOutputFactory


task "showRevision" << {
    new ByteArrayOutputStream().withStream { os ->
        def result = exec {
            executable = 'svn'
            args = ['info']
            standardOutput = os
        }
        def outputAsString = os.toString()
        def matchLastChangedRev = outputAsString =~ /Last Changed Rev: (\d+)/
        def outputFactory = services.get(StyledTextOutputFactory).create("svn.show-revision")
        outputFactory.withStyle(Style.Info).println("${matchLastChangedRev[0][1]}")
    }
}
