import org.gradle.api.Task

project(':backlog') {
    apply from:"$buildPlugins/gradlePlugins.gradle"

    task showBacklog { Task task ->
        group = 'Backlog'
        description= 'Shows backlog.'
        doLast {
            task.project.exec {
                commandLine = [
                    "${task.project.projectDir}/show.sh"
                ]
            }
        }
    }

    task hereIsSomethingTodo { Task task ->
        group = 'Backlog'
        description= 'Shows all stuff waiting for implementation.'

        doLast {
            ByteArrayOutputStream stdOut = new ByteArrayOutputStream()
            task.project.exec {
                commandLine = [
                    "${task.project.projectDir}/show.sh"
                ]
                standardOutput = stdOut
            }
            def ByteArrayInputStream stdIn = new ByteArrayInputStream(stdOut.buf)
            stdOut = new ByteArrayOutputStream()
            task.project.exec {
                standardInput = stdIn
                standardOutput = stdOut
                commandLine = ['grep', '\\-\\-\\-']
            }
            println "Here's something you could do:"
            println stdOut
        }
    }

    task featuresWaiting { Task task ->
        group = 'Backlog'
        description= 'Shows all features waiting for implementation.'
        doLast {
            ByteArrayOutputStream stdOut = new ByteArrayOutputStream()
            task.project.exec {
                commandLine = [
                    "${task.project.projectDir}/show.sh"
                ]
                standardOutput = stdOut
            }
            def ByteArrayInputStream stdIn = new ByteArrayInputStream(stdOut.buf)
            stdOut = new ByteArrayOutputStream()
            task.project.exec {
                standardInput = stdIn
                standardOutput = stdOut
                commandLine = ['grep', '\\-\\-\\-']
            }
            stdIn = new ByteArrayInputStream(stdOut.buf)
            stdOut = new ByteArrayOutputStream()
            task.project.exec {
                commandLine = ['grep' , '#feature']
                standardInput = stdIn
                standardOutput = stdOut
            }
            println stdOut
        }
    }
}